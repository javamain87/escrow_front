import{f as p,c as u,a as o,j as v,g as s,k,l as r,i as x,u as g,o as d}from"./index-CLtsJ1Nk.js";import{a as b}from"./axios-BqJF4kvB.js";const C={class:"min-h-screen bg-gradient-to-b from-[#f8f9ff] to-[#e0eaff] text-[#1c1e21] px-6 py-10"},c={class:"max-w-md mx-auto bg-white shadow-lg rounded-2xl p-8"},V={class:"space-y-4"},U=["disabled"],q={key:0},E={key:0},P={key:1},B={key:1},N={__name:"Step3Login",setup(M){const f=g(),l=p({tradeCode:"",password:"",role:"",name:"",phone:"",email:""}),n=p(!1),i=p(!1),m=p(!1),w=async()=>{if(!l.value.role){alert("역할을 먼저 선택해주세요.");return}try{const t=await b("/api/payment/check-trade-code",{tradeCode:l.value.tradeCode,role:l.value.role});if(l.value.role==="buyer"){if(!t.data)throw new Error("데이터를 찾을 수가 없습니다.");n.value=!0}else if(l.value.role==="seller")if(t.data===!0)i.value=!0,n.value=!0;else if(t.data===!1)i.value=!1,n.value=!0;else throw new Error;m.value=!0}catch{alert("거래 코드가 존재하지 않거나, 역할에 맞는 정보가 없습니다."),n.value=!1,m.value=!1}},y=async()=>{try{let t={tradeCode:l.value.tradeCode,tradePassword:l.value.password,role:l.value.role};if(l.value.role==="seller"&&!i.value){if(l.value.email===""&&l.value.phone===""){alert("Email 또는 전화번호는 필수로 입력 해주셔야 합니다.");return}t={...t,approvalPassword:l.value.password,name:l.value.name,phone:l.value.phone,email:l.value.email,company:l.value.company}}await b("/api/payment/access",t),f.push({path:"/step3",query:{tradeCode:l.value.tradeCode,tradePassword:l.value.password,role:l.value.role}})}catch{alert("거래 정보가 올바르지 않거나 접근 권한이 없습니다.")}};return(t,e)=>(d(),u("section",C,[o("div",c,[e[20]||(e[20]=o("h2",{class:"text-2xl font-bold mb-6 text-center"},"거래 정보 인증",-1)),o("div",V,[o("div",null,[e[10]||(e[10]=o("label",{class:"block font-medium mb-1"},"역할 선택",-1)),s(o("select",{"onUpdate:modelValue":e[0]||(e[0]=a=>l.value.role=a),class:"w-full border p-2 rounded",required:"",disabled:m.value},e[9]||(e[9]=[o("option",{disabled:"",value:""},"-- 선택 --",-1),o("option",{value:"buyer"},"구매자",-1),o("option",{value:"seller"},"판매자",-1)]),8,U),[[k,l.value.role]])]),o("div",null,[e[11]||(e[11]=o("label",{class:"block font-medium mb-1"},"거래 ID",-1)),s(o("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>l.value.tradeCode=a),type:"text",class:"w-full border p-2 rounded",required:""},null,512),[[r,l.value.tradeCode]])]),o("button",{onClick:w,class:"w-full py-2 px-4 bg-gray-500 text-white rounded hover:bg-gray-600"}," 조회 ")]),n.value?(d(),u("form",{key:0,onSubmit:x(y,["prevent"]),class:"space-y-4 mt-6"},[l.value.role==="seller"?(d(),u("div",q,[i.value?(d(),u("div",E,[e[12]||(e[12]=o("label",{class:"block font-medium mb-1"},"판매자 비밀번호",-1)),s(o("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>l.value.password=a),type:"password",class:"w-full border p-2 rounded",required:""},null,512),[[r,l.value.password]])])):(d(),u("div",P,[e[13]||(e[13]=o("label",{class:"block font-medium mb-1"},"이름",-1)),s(o("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>l.value.name=a),type:"text",class:"w-full border p-2 rounded",required:""},null,512),[[r,l.value.name]]),e[14]||(e[14]=o("label",{class:"block font-medium mb-1"},"상호명",-1)),s(o("input",{"onUpdate:modelValue":e[4]||(e[4]=a=>l.value.company=a),type:"text",class:"w-full border p-2 rounded",required:""},null,512),[[r,l.value.company]]),e[15]||(e[15]=o("label",{class:"block font-medium mb-1 mt-2"},"전화번호",-1)),s(o("input",{"onUpdate:modelValue":e[5]||(e[5]=a=>l.value.phone=a),type:"tel",class:"w-full border p-2 rounded"},null,512),[[r,l.value.phone]]),e[16]||(e[16]=o("label",{class:"block font-medium mb-1 mt-2"},"이메일",-1)),s(o("input",{"onUpdate:modelValue":e[6]||(e[6]=a=>l.value.email=a),type:"email",class:"w-full border p-2 rounded"},null,512),[[r,l.value.email]]),e[17]||(e[17]=o("label",{class:"block font-medium mb-1 mt-2"},"비밀번호 생성",-1)),s(o("input",{"onUpdate:modelValue":e[7]||(e[7]=a=>l.value.password=a),type:"password",class:"w-full border p-2 rounded",required:""},null,512),[[r,l.value.password]])]))])):v("",!0),l.value.role==="buyer"?(d(),u("div",B,[e[18]||(e[18]=o("label",{class:"block font-medium mb-1"},"구매자 비밀번호",-1)),s(o("input",{"onUpdate:modelValue":e[8]||(e[8]=a=>l.value.password=a),type:"password",class:"w-full border p-2 rounded",required:""},null,512),[[r,l.value.password]])])):v("",!0),e[19]||(e[19]=o("button",{type:"submit",class:"w-full py-3 px-6 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition"}," 진행하기 ",-1))],32)):v("",!0)])]))}};export{N as default};
